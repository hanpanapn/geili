(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"18M1":function(e,t,a){"use strict";var r=a("V+1I");a.n(r).a},"Cr+4":function(e,t,a){"use strict";a.r(t);var r=a("14Xm"),o=a.n(r),s=a("D3Ub"),n=a.n(s),i=a("p46w"),l=a.n(i),c={props:{dialogVisible:{type:Boolean,default:!1},formkey:{type:Number,default:0}},mounted:function(){var e=this;return n()(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.formkey){t.next=3;break}return t.next=3,e.getModel(e.formkey);case 3:return t.next=5,e.getGoodCate();case 5:case"end":return t.stop()}}),t,e)})))()},data:function(){return{header:{Authorization:"Bearer"+l.a.get("access_token")},visible:this.dialogVisible,formData:{},rules:{name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],categoryid:[{required:!0,message:"请选择商品分类",trigger:"blur"}],price_s:[{required:!0,message:"请输入单价(含税)",trigger:"blur"}],price_ns:[{required:!0,message:"请输入单价(不含税)",trigger:"blur"}],sort:[{required:!0,message:"请输入排序值",trigger:"blur"}],pers:[{required:!0,message:"请输入商品提成",trigger:"blur"}]},goodcate:[]}},methods:{getGoodCate:function(){var e=this;return n()(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$request.fetchGoodCategoryList().then((function(t){e.goodcate=t.data.rows.map((function(e){return{value:e.id,label:e.name}}))})).catch((function(e){console.log(e)}));case 1:case"end":return t.stop()}}),t,e)})))()},handlethumbnailSuccess:function(e,t){this.formData.thumbnail=e.data[0],alert(this.formData.thumbnail)},beforethumbnailUpload:function(e){var t="image/jpeg"===e.type,a="image/png"===e.type,r=e.size/1024/1024<5;return t||a||this.$message.error("图片只能是 JPG/PNG 格式!"),r||this.$message.error("图片大小不能超过 5MB!"),r&&t||a},closeCallback:function(){this.$emit("successCallback")},submitForm:function(e){var t,a=this;this.$refs[e].validate((t=n()(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=8;break}return e.next=3,a.$axios.post("/good/add",a.formData);case 3:r=e.sent,a.$message({showClose:!0,message:r.data.message,type:"success"}),a.visible=!1,e.next=10;break;case 8:return console.log("error submit!!"),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,a)}))),function(e){return t.apply(this,arguments)}))},resetForm:function(e){this.formData={}},getModel:function(e){var t=this;return n()(o.a.mark((function a(){var r;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$axios.post("/good/get",{id:e});case 2:r=a.sent,t.formData=r.data;case 4:case"end":return a.stop()}}),a,t)})))()}}},u=(a("18M1"),a("KHd+")),m={components:{PageForm:Object(u.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"添加商品",width:"720px",visible:e.visible,"destroy-on-close":""},on:{"update:visible":function(t){e.visible=t},close:e.closeCallback}},[a("el-form",{ref:"formData",attrs:{model:e.formData,"status-icon":"",rules:e.rules,"label-width":"120px",inline:!0}},[a("el-form-item",{attrs:{label:"商品图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{name:"file",headers:e.header,action:this.$path+"editor/uploadImg","show-file-list":!1,"on-success":e.handlethumbnailSuccess,"before-upload":e.beforethumbnailUpload}},[e.formData.thumbnail?a("img",{staticClass:"avatar",attrs:{src:e.formData.thumbnail}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("br"),e._v(" "),a("el-form-item",{attrs:{label:"商品分类",prop:"categoryid"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:e.formData.categoryid,callback:function(t){e.$set(e.formData,"categoryid",t)},expression:"formData.categoryid"}},e._l(e.goodcate,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{autocomplete:"off"},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单价(含税)",prop:"price_s"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{"controls-position":"right",min:0},model:{value:e.formData.price_s,callback:function(t){e.$set(e.formData,"price_s",t)},expression:"formData.price_s"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单价(不含税)",prop:"price_ns"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{"controls-position":"right",min:0},model:{value:e.formData.price_ns,callback:function(t){e.$set(e.formData,"price_ns",t)},expression:"formData.price_ns"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序值",prop:"sort"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{"controls-position":"right",min:0},model:{value:e.formData.sort,callback:function(t){e.$set(e.formData,"sort",t)},expression:"formData.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品提成",prop:"pers"}},[a("el-input-number",{staticStyle:{width:"200px"},attrs:{"controls-position":"right",min:0},model:{value:e.formData.pers,callback:function(t){e.$set(e.formData,"pers",t)},expression:"formData.pers"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商品摘要"}},[a("el-input",{staticStyle:{width:"520px"},attrs:{type:"textarea"},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1),e._v(" "),a("br"),e._v(" "),a("el-form-item",{staticStyle:{"padding-left":"247px"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("formData")}}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){return e.resetForm("formData")}}},[e._v("重 置")])],1)],1)],1)}),[],!1,null,"696bd974",null).exports},data:function(){return{total:0,goodList:[],dialogVisible:!1,title:"",formkey:0}},methods:{handleAdd:function(){this.dialogVisible=!0,this.title="添加",this.formkey=0},handleEdit:function(e,t){this.dialogVisible=!0,this.title="编辑",this.formkey=+t.id},successCallback:function(){this.dialogVisible=!1,this.getList()},handleDelete:function(e,t){var a=this;return n()(o.a.mark((function e(){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.$axios.post("/good/del",{id:t.id});case 2:"200"==(r=e.sent).status?(a.$message({showClose:!0,message:r.data.message,type:"success"}),a.getList()):console.error(r.statusText);case 4:case"end":return e.stop()}}),e,a)})))()},getList:function(){var e=this;return n()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.post("/good/getlist",{name:"",currentPage:1,pageSize:10});case 2:a=t.sent,e.goodList=a.data.rows,e.total=a.data.count;case 5:case"end":return t.stop()}}),t,e)})))()},currentChange:function(e){console.log(e),this.currentPage=e,this.getList({currentPage:e,pageSize:10})}},mounted:function(){var e=this;return n()(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getList();case 2:case"end":return t.stop()}}),t,e)})))()}},p=Object(u.a)(m,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"cardshadow roleListTable"},[a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini",plain:""},on:{click:e.handleAdd}},[e._v("添加")])],1),e._v(" "),a("el-table",{attrs:{data:e.goodList}},[a("el-table-column",{attrs:{fixed:"",prop:"created_at",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodcategory.category_name",label:"商品分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row["goodcategory.category_name"]))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"price_s",label:"单价(含税)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price_ns",label:"单价(不含税)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"排序值"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pers",label:"商品提成"}}),e._v(" "),a("el-table-column",{attrs:{prop:"desc",label:"商品摘要"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next",total:e.total},on:{"current-change":e.currentChange,"prev-click":e.currentChange,"next-click":e.currentChange}})],1),e._v(" "),e.dialogVisible?a("page-form",{attrs:{title:e.title,dialogVisible:e.dialogVisible,formkey:e.formkey},on:{successCallback:e.successCallback}}):e._e()],1)}),[],!1,null,"287872f0",null);t.default=p.exports},"V+1I":function(e,t,a){}}]);
//# sourceMappingURL=4.8df0a2f20fba93f32bda.js.map